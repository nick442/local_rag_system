I'm not certain how well this would fit your needs but have you taken a look at PearBudget? It is a pretty detailed Excel template. https://www.pearbudget.com/spreadsheet