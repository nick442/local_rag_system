Put the non violent ones to work on the farms. Cut their time in half, let the farm pay them $10 an hour collect taxes, let the farm feed and house them. If they fight, cause problems, or flee, lock them back up, losing all earned time, plus 100% of your wages as incentive to be good. A 20 year sentence for your 4th cocaine possession you get out in 10 and have 250k to start your life again.