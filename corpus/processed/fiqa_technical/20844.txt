In all honesty, the best solution I've come across is Microsoft's now defunct Money.