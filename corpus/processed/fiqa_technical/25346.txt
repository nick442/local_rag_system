For the CPI, there is actually federal employees whose job it is to visit various stores to collect the prices of specific items (boy's size-14 collared shirt made of 97 percent cotton). Planet Money did a great podcast on this, actually following one of these people for a day.