a bank doesn't lend you money if it hasn't made sure that you can repay your debt in full (plus interests). That's not entirely correct. The bank issues a lot of loans and expects almost all people will pay their debts. The few people who go bankrupt and cannot pay are (more than) compensated for by the people who do pay their debts. The same holds for brokers, e.g. here is an example of the rates they calculate when you trade on margin, effectively borrowing money from them.