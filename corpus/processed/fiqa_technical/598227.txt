You may get some advice here, but you REALLY need to talk to a tax adviser who is familiar with the laws of both states, or possible two, one from each state. There is a significant amount of money on the line here, not just tax but penalties and interest if you get this wrong. Once you get it figured out, you probably will be able to take care of it yourself in the future, but make sure that it gets done right initially.