Yes. Look at form 1040 AGI is line 37, and it comes well after you report your schedule D cap gains. I read this question as meaning you wish to contribute to a traditional IRA pretax. There is no income limit to contribute to an IRA and not take the deduction.