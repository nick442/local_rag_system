"Nobody knows for sure what ""substantially identical"" means because the IRS hasn't officially defined it. Until they do so, it would come down to the decision of an auditor or a tax court. The rule of thumb that I have always heard is if the funds track the same index, they are probably substantially identical. I think most people wouldn't consider any pair of AGG, CMF, and NYF to be substantially identical, so you should be safe with your tax-loss harvesting strategy."